


<html lang="ja">
<head>
<title>あなたの地域のお天気</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script> 
<script src='https://use.fontawesome.com/releases/v5.0.13/js/all.js'></script>
<link rel="stylesheet" href="weather.css">
</head>
<body>
    <div class="container">

        <div>
<br>
<br>
<br>
          <h2>都市を選ぶ</h2>
            <input type="radio" id="cityRadio" name="cityRadio" value="1850147">Tokyo
            <input type="radio" id="cityRadio" name="cityRadio" value="1853909">Osaka
            <input type="radio" id="cityRadio" name="cityRadio" value="1894616">Okinawa
            <input type="radio" id="cityRadio" name="cityRadio" value="1835841">Korea
            <input type="radio" id="cityRadio" name="cityRadio" value="1857910">Kyoto
            <input type="radio" id="cityRadio" name="cityRadio" value="2643743">London
            <button id="submit"><i class="fas fa-paper-plane"></i>  Click</button>
        </div> 
        <div class="weatherMain"> 
            <h2>現在の天気は</h2>
            <div><span id = "weather" class="bold"></span></div>
            <div><span id = "weatherMark" class="bold"></span></div>
            <p id="icon"></p>
        </div>
        <div>気温　<span id = "temp"  class="bold"></span>　℃</div>
        <div>湿度　<span id = "humidity" class="bold"></span>　%</div></div>
    
    <script>

  $(function() {
  var API_KEY = 'c965525d0b43d446a807664d5ac8d853'
  var city = 'Tokyo';
  var url = 'http://api.openweathermap.org/data/2.5/forecast?q=' + city + ',jp&units=metric&APPID=' + API_KEY;
  $.ajax({
    url: url,
    dataType: "json",
    type: 'GET',
  })
  .done(function(data) {
    var insertHTML = "";
    var cityName = '<h2>' + data.city.name + '</h2>';
    $('#city-name').html(cityName);
    for (var i = 0; i <= 8; i = i + 2) {
      insertHTML += buildHTML(data, i);
    }
    $('#weather').html(insertHTML);
  })
  .fail(function(data) {
    console.log("失敗しました");
  });
});function buildHTML(data, i) {
  var Week = new Array("（日）","（月）","（火）","（水）","（木）","（金）","（土）");
  var date = new Date (data.list[i].dt_txt);
  date.setHours(date.getHours() + 9);
  var month = date.getMonth()+1;
  var day = month + "月" + date.getDate() + "日" + Week[date.getDay()] + date.getHours() + "：00";
  var icon = data.list[i].weather[0].icon;
  var html =
  '<div class="weather-report">' +
    '<img src="http://openweathermap.org/img/w/' + icon + '.png">' +
    '<div class="weather-date">' + day + '</div>' +
    '<div class="weather-main">'+ data.list[i].weather[0].main + '</div>' +
    '<div class="weather-temp">' + Math.round(data.list[i].main.temp) + '℃</div>' +
  '</div>';
  return html
}


</script>

<% @codes.each do |code| %>
<%= attachment_image_tag code,:code_image, :fill,110,110,fallback: "",size: "100*100" %>
<% end %>




</body>